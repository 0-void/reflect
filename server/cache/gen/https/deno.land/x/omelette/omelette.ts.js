import { EventEmitter } from "https://deno.land/std@0.53.0/node/events.ts";
import * as path from "https://deno.land/std@0.53.0/path/mod.ts";
const hasProp = {}.hasOwnProperty;
function depthOf(object) {
    let key, depth, level;
    level = 1;
    for (let key in object) {
        if (!hasProp.call(object, key))
            continue;
        if (typeof object[key] === "object") {
            depth = depthOf(object[key]) + 1;
            level = Math.max(depth, level);
        }
    }
    return level;
}
class Omelette extends EventEmitter {
    constructor() {
        super();
        this.programs = [];
        this.program = "";
        this.shell = "";
        this.fragments = [];
        // let isFish: boolean, isZsh: boolean, ref: string;
        let isZsh, ref;
        this.asyncs = 0;
        this.compgen = Deno.args.indexOf("--compgen");
        this.install = Deno.args.indexOf("--completion") > -1;
        this.installFish = Deno.args.indexOf("--completion-fish") > -1;
        isZsh = Deno.args.indexOf("--compzsh") > -1;
        // isFish = Deno.args.indexOf("--compfish") > -1;
        this.isDebug = Deno.args.indexOf("--debug") > -1;
        this.fragment = parseInt(Deno.args[this.compgen + 1]) -
            (isZsh ? 1 : 0);
        this.line = Deno.args.slice(this.compgen + 3).join(" ");
        this.word = (ref = this.line) != null
            ? ref.trim().split(/\s+/).pop()
            : void 0;
        this.mainProgram = function () { };
    }
    setProgram(programs) {
        const splittedPrograms = programs.split("|");
        this.program = splittedPrograms[0];
        return this.programs = splittedPrograms.map(function (program) {
            return program.replace(/[^A-Za-z0-9\.\_\-]/g, "");
            // Do not allow except:
            // .. uppercase
            // .. lowercase
            // .. numbers
            // .. dots
            // .. underscores
            // .. dashes
        });
    }
    setFragments(...fragments1) {
        this.fragments = fragments1;
    }
    generate() {
        let data = {
            before: this.word,
            fragment: this.fragment,
            line: this.line,
            reply: this.reply,
        };
        this.emit("complete", this.fragments[this.fragment - 1], data);
        this.emit(this.fragments[this.fragment - 1], data);
        this.emit(`$${this.fragment}`, data);
        if (this.asyncs === 0) {
            return Deno.exit();
        }
    }
    reply(words = []) {
        let writer = function (options) {
            console.log(typeof options.join === "function" ? options.join("\n") : void 0);
            return Deno.exit();
        };
        if (words instanceof Promise) {
            return words.then(writer);
        }
        else {
            return writer(words);
        }
    }
    next(handler) {
        if (typeof handler === "function") {
            return this.mainProgram = handler;
        }
    }
    tree(objectTree = {}) {
        let depth, i, level, ref;
        depth = depthOf(objectTree);
        for (level = i = 1, ref = depth; (1 <= ref ? i <= ref : i >= ref); level = 1 <= ref ? ++i : --i) {
            this.on(`$${level}`, function ({ fragment, reply, line }) {
                let accessor, lastIndex, replies;
                if (!(/\s+/.test(line.slice(-1)))) {
                    lastIndex = -1;
                }
                accessor = (t) => line.split(/\s+/).slice(1, lastIndex).filter(Boolean).reduce((a, v) => a[v], t);
                replies = fragment === 1
                    ? Object.keys(objectTree)
                    : accessor(objectTree);
                return reply((function (replies) {
                    if (replies instanceof Function) {
                        return replies();
                    }
                    if (replies instanceof Array) {
                        return replies;
                    }
                    if (replies instanceof Object) {
                        return Object.keys(replies);
                    }
                })(replies));
            });
        }
        return this;
    }
    generateCompletionCode() {
        let completions = this.programs.map((program) => {
            let completion;
            completion = `_${program}_completion`;
            return `### ${program} completion - begin. generated by omelette.js ###\nif type compdef &>/dev/null; then\n  ${completion}() {\n    compadd -- \`${this.program} --compzsh --compgen "\${CURRENT}" "\${words[CURRENT-1]}" "\${BUFFER}"\`\n  }\n  compdef ${completion} ${program}\nelif type complete &>/dev/null; then\n  ${completion}() {\n    local cur prev nb_colon\n    _get_comp_words_by_ref -n : cur prev\n    nb_colon=$(grep -o ":" <<< "$COMP_LINE" | wc -l)\n\n    COMPREPLY=( $(compgen -W '$(${this.program} --compbash --compgen "$((COMP_CWORD - (nb_colon * 2)))" "$prev" "\${COMP_LINE}")' -- "$cur") )\n\n    __ltrim_colon_completions "$cur"\n  }\n  complete -F ${completion} ${program}\nfi\n### ${program} completion - end ###`;
        });
        if (this.isDebug) {
            // Adding aliases for testing purposes
            completions.push(this.generateTestAliases());
        }
        return completions.join("\n");
    }
    generateCompletionCodeFish() {
        let completions = this.programs.map((program) => {
            let completion;
            completion = `_${program}_completion`;
            return `### ${program} completion - begin. generated by omelette.js ###\nfunction ${completion}\n  ${this.program} --compfish --compgen (count (commandline -poc)) (commandline -pt) (commandline -pb)\nend\ncomplete -f -c ${program} -a '(${completion})'\n### ${program} completion - end ###`;
        });
        if (this.isDebug) {
            // Adding aliases for testing purposes
            completions.push(this.generateTestAliases());
        }
        return completions.join("\n");
    }
    generateTestAliases() {
        let debugAliases, debugUnaliases, fullPath;
        fullPath = path.join(Deno.cwd(), this.program);
        debugAliases = this.programs.map(function (program) {
            return `  alias ${program}=${fullPath}`;
        }).join("\n");
        debugUnaliases = this.programs.map(function (program) {
            return `  unalias ${program}`;
        }).join("\n");
        return `### test method ###\nomelette-debug-${this.program}() {\n${debugAliases}\n}\nomelette-nodebug-${this.program}() {\n${debugUnaliases}\n}\n### tests ###`;
    }
    checkInstall() {
        if (this.install) {
            console.log(this.generateCompletionCode());
            Deno.exit();
        }
        if (this.installFish) {
            console.log(this.generateCompletionCodeFish());
            return Deno.exit();
        }
    }
    init() {
        if (this.compgen > -1) {
            return this.generate();
        }
        else {
            return this.mainProgram();
        }
    }
    onAsync(event, handler) {
        super.on(event, handler);
        return this.asyncs += 1;
    }
}
function omelette(template, ...args) {
    let program, callbacks, fragments;
    if (template instanceof Array && args.length > 0) {
        [program, callbacks] = [template[0].trim(), args];
        fragments = callbacks.map(function (callback, index) {
            return `arg${index}`;
        });
    }
    else {
        [program, ...fragments] = template.split(/\s+/);
        callbacks = [];
    }
    fragments = fragments.map(function (fragment) {
        return fragment.replace(/^\<+|\>+$/g, "");
    });
    const om = new Omelette();
    om.setProgram(program);
    om.setFragments(...fragments);
    om.checkInstall();
    let callback;
    let fragment;
    for (let i, index = i = 0, len = callbacks.length; i < len; index = ++i) {
        callback = callbacks[index];
        fragment = `arg${index}`;
        (function (callback) {
            return om.on(fragment, function (...args) {
                return om.reply(callback instanceof Array ? callback : callback(...args));
            });
        })(callback);
    }
    return om;
}
export default omelette;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib21lbGV0dGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJodHRwczovL2Rlbm8ubGFuZC94L29tZWxldHRlL29tZWxldHRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSw2Q0FBNkMsQ0FBQztBQUMzRSxPQUFPLEtBQUssSUFBSSxNQUFNLDBDQUEwQyxDQUFDO0FBQ2pFLE1BQU0sT0FBTyxHQUFHLEVBQUUsQ0FBQyxjQUFjLENBQUM7QUFFbEMsU0FBUyxPQUFPLENBQUMsTUFBVztJQUMxQixJQUFJLEdBQVEsRUFBRSxLQUFhLEVBQUUsS0FBYSxDQUFDO0lBQzNDLEtBQUssR0FBRyxDQUFDLENBQUM7SUFDVixLQUFLLElBQUksR0FBRyxJQUFJLE1BQU0sRUFBRTtRQUN0QixJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDO1lBQUUsU0FBUztRQUN6QyxJQUFJLE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLFFBQVEsRUFBRTtZQUNuQyxLQUFLLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNqQyxLQUFLLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7U0FDaEM7S0FDRjtJQUNELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQUVELE1BQU0sUUFBUyxTQUFRLFlBQVk7SUFnQmpDO1FBQ0UsS0FBSyxFQUFFLENBQUM7UUFUVixhQUFRLEdBQWEsRUFBRSxDQUFDO1FBQ3hCLFlBQU8sR0FBVyxFQUFFLENBQUM7UUFDckIsVUFBSyxHQUFXLEVBQUUsQ0FBQztRQUVuQixjQUFTLEdBQWEsRUFBRSxDQUFDO1FBTXZCLG9EQUFvRDtRQUNwRCxJQUFJLEtBQWMsRUFBRSxHQUFXLENBQUM7UUFDaEMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7UUFD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